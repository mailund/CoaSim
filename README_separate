
Running separate.py
--------------

Usage: 
separate.py -i <input-file> -ocases <output-case-file> -ocontrols <output-control-file> -number_disease_markers <number_disease_markers> -disease_positions <trait positions> -disease_alleles <trait alleles> -number_cases_with_mutation <cases with mutations> -number_controls_with_mutation <controls with mutations> -number_controls <number of controls> -number_cases <number of cases> -dtd <dtd-file> -randomphase -text_format

separate.py is a tool for separating the output XML file  from CoaSim 
into cases and controls. A mutation is defined as a  sequence having 
a number (typical one) specific alleles at given markers. Separate.py
first separates the mutated sequences from the non-mutated and removes
the marker at the trait position. The sequences are then partitioned
into cases and controls. Controls may be constructed to contain a 
specific number of mutated sequences, and the cases may be constructed
to contain a number of non-mutated sequences. These cases and control
sequences are now coupled with non-mutated sequences to generate 
genotypes. The phase for the genotypes may be either random or fixed. 

Options
-------

The mandatory OPTIONS are

-i                                          <input-file>

				            The XML input file generated by CoaSim

-ocases                                     <output-case-file>

                                            The output file containing the generated cases

-ocontrols                                  <output-control-file>

                                            The output file containing the generated controls

-number_disease_markers                     <number_disease_markers>

                                            The number of traits 

-disease_positions                          <trait positions>

                                            The position of the traits (ie. for one trait "0.233", for two traits "0.233 0.555")

-disease_alleles                            <trait alleles>

                                            The list alleles at the trait positions defining the mutation (ie. for one trait "1", for two traits "1 2")

-number_cases_with_mutation                 <cases with mutations> 
                                              
                                            Number of cases carrying the trait allele


-number_controls_with_mutation              <controls with mutations> 

                                            Number of controls carrying the trait allele

-number_controls <number of controls> 
         
                                            Number of controls to be generated

-number_cases                               <number of cases> 

                                            Number of cases to be generated


-dtd                                        <dtd-file> 

                                            A dtd file describing the output (ie. bioinformatics.dtd)

Optional OPTIONS:

-randomphase 
	                                    The output genotype data has a random phase

-text_format
	                                    if this option is included, output is produced in the format 
                                            A A' B B' C C' .....
                                            where A and A' are the alleles at marker 1, B and B' are the alleles at 
                                            marker 2 ....
	                                    if the option is not set, the output file is an XML file specified by
	                                    bioinformatics.dtd


Example
-------

A CoaSim output XML-file may be generated by:

coasim -o output.xml -gl 0.0 -gr 0.0 -rr 1.0 -exp 0.0 -mr 1.0 -ln 1000 
       -v "{ 0 1 } { 0 1 } { 0 1 } { 0 1 } { 0 1 } { 0 1 } { 0 1 } { 0 1 } { 0 1 } { 0 1 } { 0 1 }" 
       -rand 1 -marker_type "1 1 1 1 1 1 1 2 1 1 1" 
       -pos "0.01 0.11 0.22 0.33 0.44 0.55 0.66 0.76 0.77 0.88 0.99" 
       -low_freq "0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.18 0.2 0.2 0.2" 
       -high_freq "0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.22 0.8 0.8 0.8" 
       -dtd coasim.dtd -log coasim.log -mode leaf_nodes_only

and the output (output.xml) may be separated into cases and controls by:

separate.py -i output.xml -ocases cases -ocontrols controls -number_disease_markers 1 
            -disease_positions 0.76 -disease_alleles 1 -number_cases_with_mutation 80 
            -number_controls_with_mutation 30 -number_controls 100 -number_cases 100 
            -dtd bioinformatics.dtd -randomphase -text_format

